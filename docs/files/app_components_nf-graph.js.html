<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app/components/nf-graph.js - ember-nf-graph</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="ember-nf-graph" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/components.nf-area.html">components.nf-area</a></li>
                                <li><a href="../classes/components.nf-area-stack.html">components.nf-area-stack</a></li>
                                <li><a href="../classes/components.nf-bars.html">components.nf-bars</a></li>
                                <li><a href="../classes/components.nf-crosshair.html">components.nf-crosshair</a></li>
                                <li><a href="../classes/components.nf-dot.html">components.nf-dot</a></li>
                                <li><a href="../classes/components.nf-gg.html">components.nf-gg</a></li>
                                <li><a href="../classes/components.nf-graph.html">components.nf-graph</a></li>
                                <li><a href="../classes/components.nf-graph-content.html">components.nf-graph-content</a></li>
                                <li><a href="../classes/components.nf-horizontal-line.html">components.nf-horizontal-line</a></li>
                                <li><a href="../classes/components.nf-line.html">components.nf-line</a></li>
                                <li><a href="../classes/components.nf-plot.html">components.nf-plot</a></li>
                                <li><a href="../classes/components.nf-range-marker.html">components.nf-range-marker</a></li>
                                <li><a href="../classes/components.nf-range-markers.html">components.nf-range-markers</a></li>
                                <li><a href="../classes/components.nf-right-tick.html">components.nf-right-tick</a></li>
                                <li><a href="../classes/components.nf-selection-box.html">components.nf-selection-box</a></li>
                                <li><a href="../classes/components.nf-svg-image.html">components.nf-svg-image</a></li>
                                <li><a href="../classes/components.nf-svg-line.html">components.nf-svg-line</a></li>
                                <li><a href="../classes/components.nf-svg-path.html">components.nf-svg-path</a></li>
                                <li><a href="../classes/components.nf-svg-rect.html">components.nf-svg-rect</a></li>
                                <li><a href="../classes/components.nf-tracker.html">components.nf-tracker</a></li>
                                <li><a href="../classes/components.nf-vertical-line.html">components.nf-vertical-line</a></li>
                                <li><a href="../classes/components.nf-x-axis.html">components.nf-x-axis</a></li>
                                <li><a href="../classes/components.nf-y-axis.html">components.nf-y-axis</a></li>
                                <li><a href="../classes/components.nf-y-diff.html">components.nf-y-diff</a></li>
                                <li><a href="../classes/mixins.graph-area-utils.html">mixins.graph-area-utils</a></li>
                                <li><a href="../classes/mixins.graph-data-graphic.html">mixins.graph-data-graphic</a></li>
                                <li><a href="../classes/mixins.graph-has-graph-parent.html">mixins.graph-has-graph-parent</a></li>
                                <li><a href="../classes/mixins.graph-line-utils.html">mixins.graph-line-utils</a></li>
                                <li><a href="../classes/mixins.graph-registered-graphic.html">mixins.graph-registered-graphic</a></li>
                                <li><a href="../classes/mixins.graph-requires-scale-source.html">mixins.graph-requires-scale-source</a></li>
                                <li><a href="../classes/mixins.graph-selectable-graphic.html">mixins.graph-selectable-graphic</a></li>
                                <li><a href="../classes/utils.nf.graph-event.html">utils.nf.graph-event</a></li>
                                <li><a href="../classes/utils.nf.graph-mouse-event.html">utils.nf.graph-mouse-event</a></li>
                                <li><a href="../classes/utils.nf.graph-position.html">utils.nf.graph-position</a></li>
                                <li><a href="../classes/utils.nf.scroll-area-action-context.html">utils.nf.scroll-area-action-context</a></li>
                                <li><a href="../classes/utils.parse-property-expression.html">utils.parse-property-expression</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/scale-utils.html">scale-utils</a></li>
                                <li><a href="../modules/utils_nf_array-helpers.html">utils/nf/array-helpers</a></li>
                                <li><a href="../modules/utils_nf_svg-dom.html">utils/nf/svg-dom</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: app/components/nf-graph.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Ember from &#x27;ember&#x27;;
import GraphPosition from &#x27;ember-nf-graph/utils/nf/graph-position&#x27;;
import { getMousePoint } from &#x27;ember-nf-graph/utils/nf/svg-dom&#x27;;
import { toArray } from &#x27;ember-nf-graph/utils/nf/array-helpers&#x27;;

var Observable = Rx.Observable;

var computedBool = Ember.computed.bool;

var scaleFactoryProperty = function(axis) {
  var scaleTypeKey = axis + &#x27;ScaleType&#x27;;
  var powExponentKey = axis + &#x27;PowerExponent&#x27;;

  return Ember.computed(scaleTypeKey, powExponentKey, function(){
    var type = this.get(scaleTypeKey);
    var powExp = this.get(powExponentKey);

    type = typeof type === &#x27;string&#x27; ? type.toLowerCase() : &#x27;&#x27;;
    
    if(type === &#x27;linear&#x27;) {
      return d3.scale.linear;
    }

    else if(type === &#x27;ordinal&#x27;) {
      return function(){ 
        var scale = d3.scale.ordinal();
        // ordinal scales don&#x27;t have an invert function, so we need to add one
        scale.invert = function(rv) {
          var [min, max] = d3.extent(scale.range());
          var domain = scale.domain();
          var i = Math.round((domain.length - 1) * (rv - min) / (max - min));
          return domain[i];
        };
        return scale;
      }
    }
    
    else if(type === &#x27;power&#x27; || type === &#x27;pow&#x27;) {
      return function(){
        return d3.scale.pow().exponent(powExp);
      };
    }
    
    else if(type === &#x27;log&#x27;) {
      return d3.scale.log;
    }
    
    else {
      Ember.warn(&#x27;unknown scale type: &#x27; + type);
      return d3.scale.linear;
    }
  });
};

var domainProperty = function(axis) {
  var dataKey = axis + &#x27;UniqueData&#x27;;
  var minKey = axis + &#x27;Min&#x27;;
  var maxKey = axis + &#x27;Max&#x27;;
  var scaleTypeKey = axis + &#x27;ScaleType&#x27;;
  var logMinKey = axis + &#x27;LogMin&#x27;;

  return Ember.computed(dataKey + &#x27;.@each&#x27;, minKey, maxKey, scaleTypeKey, logMinKey, function(){
    var data = this.get(dataKey);
    var min = this.get(minKey);
    var max = this.get(maxKey);
    var scaleType = this.get(scaleTypeKey);
    var logMin = this.get(logMinKey);
    var domain = null;

    if(scaleType === &#x27;ordinal&#x27;) {
      domain = data;
    } else {
      var extent = [min, max];

      if(scaleType === &#x27;log&#x27;) {
        if (extent[0] &lt;= 0) {
          extent[0] = logMin;
        }
        if (extent[1] &lt;= 0) {
          extent[1] = logMin;
        }
      }

      domain = extent;
    }

    return domain;
  });
};

var scaleProperty = function(axis) {
  var scaleFactoryKey = axis + &#x27;ScaleFactory&#x27;; 
  var rangeKey = axis + &#x27;Range&#x27;; 
  var domainKey = axis + &#x27;Domain&#x27;; 
  var scaleTypeKey = axis + &#x27;ScaleType&#x27;;
  var ordinalPaddingKey = axis + &#x27;OrdinalPadding&#x27;; 
  var ordinalOuterPaddingKey = axis + &#x27;OrdinalOuterPadding&#x27;;

  return Ember.computed(
    scaleFactoryKey,
    rangeKey,
    scaleTypeKey,
    ordinalPaddingKey,
    domainKey,
    ordinalOuterPaddingKey,
    function(){
      var scaleFactory = this.get(scaleFactoryKey);
      var range = this.get(rangeKey);
      var domain = this.get(domainKey);
      var scaleType = this.get(scaleTypeKey);
      var ordinalPadding = this.get(ordinalPaddingKey);
      var ordinalOuterPadding = this.get(ordinalOuterPaddingKey);

      var scale = scaleFactory();

      if(scaleType === &#x27;ordinal&#x27;) {
        scale = scale.domain(domain).rangeBands(range, ordinalPadding, ordinalOuterPadding);
      } else {        
        scale = scale.domain(domain).range(range).clamp(true);
      }

      return scale;
    }
  );
};

var minProperty = function(axis, defaultTickCount){
  var _DataExtent_ = axis + &#x27;DataExtent&#x27;;
  var _MinMode_ = axis + &#x27;MinMode&#x27;;
  var _Axis_tickCount_ = axis + &#x27;Axis.tickCount&#x27;;
  var _ScaleFactory_ = axis + &#x27;ScaleFactory&#x27;;
  var __Min_ = &#x27;_&#x27; + axis + &#x27;Min&#x27;;
  var _prop_ = axis + &#x27;Min&#x27;;
  var _autoScaleEvent_ = &#x27;didAutoUpdateMin&#x27; + axis.toUpperCase();

  return Ember.computed(
    _MinMode_,
    _DataExtent_,
    _Axis_tickCount_,
    _ScaleFactory_,
    function(key, value) {
      var mode = this.get(_MinMode_);
      var ext;

      if(arguments.length &gt; 1) {
        this[__Min_] = value;
      } else {
        var self = this;

        var change = function(val) {
          self.set(_prop_, val);
          self.trigger(_autoScaleEvent_);
        };

        if(mode === &#x27;auto&#x27;) {
          change(this.get(_DataExtent_)[0] || 0);
        }

        else if(mode === &#x27;push&#x27;) {
          ext = this.get(_DataExtent_)[0];
          if(!isNaN(ext) &amp;&amp; ext &lt; this[__Min_]) {
            change(ext);
          }
        }

        else if(mode === &#x27;push-tick&#x27;) {
          var extent = this.get(_DataExtent_);
          ext = extent[0];

          if(!isNaN(ext) &amp;&amp; ext &lt; this[__Min_]) {
            var tickCount = this.get(_Axis_tickCount_) || defaultTickCount;
            var newDomain = this.get(_ScaleFactory_)().domain(extent).nice(tickCount).domain();
            change(newDomain[0]);
          }
        }
      }

      return this[__Min_];
    }
  );
};

var maxProperty = function(axis, defaultTickCount) {
  var _DataExtent_ = axis + &#x27;DataExtent&#x27;;
  var _Axis_tickCount_ = axis + &#x27;Axis.tickCount&#x27;;
  var _ScaleFactory_ = axis + &#x27;ScaleFactory&#x27;;
  var _MaxMode_ = axis + &#x27;MaxMode&#x27;;
  var __Max_ = &#x27;_&#x27; + axis + &#x27;Max&#x27;;
  var _prop_ = axis + &#x27;Max&#x27;;
  var _autoScaleEvent_ = &#x27;didAutoUpdateMax&#x27; + axis.toUpperCase();

  return Ember.computed(
    _MaxMode_,
    _DataExtent_,
    _ScaleFactory_,
    _Axis_tickCount_,
    function(key, value) {
      var mode = this.get(_MaxMode_);
      var ext;

      if(arguments.length &gt; 1) {
        this[__Max_] = value;
      } else {
        var self = this;

        var change = function(val) {
          self.set(_prop_, val);
          self.trigger(_autoScaleEvent_);
        };

        if(mode === &#x27;auto&#x27;) {
          change(this.get(_DataExtent_)[1] || 1);
        }

        else if(mode === &#x27;push&#x27;) {
          ext = this.get(_DataExtent_)[1];
          if(!isNaN(ext) &amp;&amp; this[__Max_] &lt; ext) {
            change(ext);
          }
        }

        else if(mode === &#x27;push-tick&#x27;) {
          var extent = this.get(_DataExtent_);
          ext = extent[1];

          if(!isNaN(ext) &amp;&amp; this[__Max_] &lt; ext) {
            var tickCount = this.get(_Axis_tickCount_) || defaultTickCount;
            var newDomain = this.get(_ScaleFactory_)().domain(extent).nice(tickCount).domain();
            change(newDomain[1]);
          }
        }
      }

      return this[__Max_];
    }
  );
};

/**
  A container component for building complex Cartesian graphs.

  ## Minimal example

       {{#nf-graph width=100 height=50}}
         {{#nf-graph-content}}
           {{nf-line data=lineData xprop=&quot;foo&quot; yprop=&quot;bar&quot;}}
         {{/nf-graph-content}}
       {{/nf-graph}}

  The above will create a simple 100x50 graph, with no axes, and a single line
  plotting the data it finds on each object in the array &#x60;lineData&#x60; at properties
  &#x60;foo&#x60; and &#x60;bar&#x60; for x and y values respectively.

  ## More advanced example

       {{#nf-graph width=500 height=300}}
         {{#nf-x-axis height=&quot;50&quot; as |tick|}}
           &lt;text&gt;{{tick.value}}&lt;/text&gt;
         {{/nf-x-axis}}

         {{#nf-y-axis width=&quot;120&quot; as |tick|}}
           &lt;text&gt;{{tick.value}}&lt;/text&gt;
         {{/nf-y-axis}}
   
         {{#nf-graph-content}}
           {{nf-line data=lineData xprop=&quot;foo&quot; yprop=&quot;bar&quot;}}
         {{/nf-graph-content}}
       {{/nf-graph}}

  The above example will create a 500x300 graph with both axes visible. The graph will not 
  render either axis unless its component is present.


  @namespace components
  @class nf-graph
  @extends Ember.Component
*/
export default Ember.Component.extend({
  tagName: &#x27;div&#x27;,  

  /**
    The exponent to use for xScaleType &quot;pow&quot; or &quot;power&quot;.
    @property xPowerExponent
    @type Number
    @default 3
  */
  xPowerExponent: 3,

  /**
    The exponent to use for yScaleType &quot;pow&quot; or &quot;power&quot;.
    @property yPowerExponent
    @type Number
    @default 3
  */
  yPowerExponent: 3,

  /**
    The min value to use for xScaleType &quot;log&quot; if xMin &lt;= 0
    @property xLogMin
    @type Number
    @default 0.1
  */
  xLogMin: 0.1,

  /**
    The min value to use for yScaleType &quot;log&quot; if yMin &lt;= 0
    @property yLogMin
    @type Number
    @default 0.1
  */
  yLogMin: 0.1,

  /** 
    Allows child compoenents to identify graph parent.
    @property isGraph
    @private
  */
  isGraph: true,

  /**
    Identifies this graph to its children as providing scales.
    @property isScaleSource
    @private
  */
  isScaleSource: true,

  /**
    @property hasRendered
    @private
  */
  hasRendered: false,

  /**
    Gets or sets the whether or not multiple selectable graphics may be
    selected simultaneously.
    @property selectMultiple
    @type Boolean
    @default false
  */
  selectMultiple: false,

  /**
    The width of the graph in pixels.
    @property width
    @type Number
    @default 300
  */
  width: 300,

  /**
    The height of the graph in pixels.
    @property height
    @type Number
    @default 100
  */
  height: 100,

  /**
    The padding at the top of the graph
    @property paddingTop
    @type Number
    @default 0
  */
  paddingTop: 0,

  /**
    The padding at the left of the graph
    @property paddingLeft
    @type Number
    @default 0
  */
  paddingLeft: 0,

  /**
    The padding at the right of the graph
    @property paddingRight
    @type Number
    @default 0
  */
  paddingRight: 0,

  /**
    The padding at the bottom of the graph
    @property paddingBottom
    @type Number
    @default 0
  */
  paddingBottom: 0,

  /**
    Determines whether to display &quot;lanes&quot; in the background of
    the graph.
    @property showLanes
    @type Boolean
    @default false
  */
  showLanes: false,

  /**
    Determines whether to display &quot;frets&quot; in the background of
    the graph.
    @property showFrets
    @type Boolean
    @default false 
  */
  showFrets: false,

  /**
    The type of scale to use for x values.
    
    Possible Values:
    - &#x60;&#x27;linear&#x27;&#x60; - a standard linear scale
    - &#x60;&#x27;log&#x27;&#x60; - a logarithmic scale
    - &#x60;&#x27;power&#x27;&#x60; - a power-based scale (exponent = 3)
    - &#x60;&#x27;ordinal&#x27;&#x60; - an ordinal scale, used for ordinal data. required for bar graphs.
    
    @property xScaleType
    @type String
    @default &#x27;linear&#x27;
  */
  xScaleType: &#x27;linear&#x27;,

  /**
    The type of scale to use for y values.
    
    Possible Values:
    - &#x60;&#x27;linear&#x27;&#x60; - a standard linear scale
    - &#x60;&#x27;log&#x27;&#x60; - a logarithmic scale
    - &#x60;&#x27;power&#x27;&#x60; - a power-based scale (exponent = 3)
    - &#x60;&#x27;ordinal&#x27;&#x60; - an ordinal scale, used for ordinal data. required for bar graphs.
    
    @property yScaleType
    @type String
    @default &#x27;linear&#x27;
  */
  yScaleType: &#x27;linear&#x27;,
  
  /**
    The padding between value steps when &#x60;xScaleType&#x60; is &#x60;&#x27;ordinal&#x27;&#x60;
    @property xOrdinalPadding
    @type Number
    @default 0.1
  */
  xOrdinalPadding: 0.1,

  /**
    The padding at the ends of the domain data when &#x60;xScaleType&#x60; is &#x60;&#x27;ordinal&#x27;&#x60;
    @property xOrdinalOuterPadding
    @type Number
    @default 0.1
  */
  xOrdinalOuterPadding: 0.1,

  /**
    The padding between value steps when &#x60;xScaleType&#x60; is &#x60;&#x27;ordinal&#x27;&#x60;
    @property yOrdinalPadding
    @type Number
    @default 0.1
  */
  yOrdinalPadding: 0.1,

  /**
    The padding at the ends of the domain data when &#x60;yScaleType&#x60; is &#x60;&#x27;ordinal&#x27;&#x60;
    @property yOrdinalOuterPadding
    @type Number
    @default 0.1
  */
  yOrdinalOuterPadding: 0.1,

  /**
    the &#x60;nf-y-axis&#x60; component is registered here if there is one present
    @property yAxis
    @readonly
    @default null
  */
  yAxis: null,

  /**
    The &#x60;nf-x-axis&#x60; component is registered here if there is one present
    @property xAxis
    @readonly
    @default null
  */
  xAxis: null,

  /**
    Backing field for &#x60;xMin&#x60;
    @property _xMin
    @private
  */
  _xMin: null,

  /**
    Backing field for &#x60;xMax&#x60;
    @property _xMax
    @private
  */
  _xMax: null,

  /**
    Backing field for &#x60;yMin&#x60;
    @property _yMin
    @private
  */
  _yMin: null,

  /**
    Backing field for &#x60;yMax&#x60;
    @property _yMax
    @private
  */
  _yMax: null,

  /**
    Gets or sets the minimum x domain value to display on the graph.
    Behavior depends on &#x60;xMinMode&#x60;.
    @property xMin
  */
  xMin: minProperty(&#x27;x&#x27;, 8),

  /**
    Gets or sets the maximum x domain value to display on the graph.
    Behavior depends on &#x60;xMaxMode&#x60;.
    @property xMax
  */
  xMax: maxProperty(&#x27;x&#x27;, 8),

  /**
    Gets or sets the minimum y domain value to display on the graph.
    Behavior depends on &#x60;yMinMode&#x60;.
    @property yMin
  */
  yMin: minProperty(&#x27;y&#x27;, 5),

  /**
    Gets or sets the maximum y domain value to display on the graph.
    Behavior depends on &#x60;yMaxMode&#x60;.
    @property yMax
  */
  yMax: maxProperty(&#x27;y&#x27;, 5),
  

  /**
    Sets the behavior of &#x60;xMin&#x60; for the graph.

    ### Possible values:

    - &#x27;auto&#x27;: (default) xMin is always equal to the minimum domain value contained in the graphed data. Cannot be set.
    - &#x27;fixed&#x27;: xMin can be set to an exact value and will not change based on graphed data.
    - &#x27;push&#x27;: xMin can be set to a specific value, but will update if the minimum x value contained in the graph is less than 
      what xMin is currently set to.
    - &#x27;push-tick&#x27;: xMin can be set to a specific value, but will update to next &quot;nice&quot; tick if the minimum x value contained in
      the graph is less than that xMin is set to.

    @property xMinMode
    @type String
    @default &#x27;auto&#x27;
  */
  xMinMode: &#x27;auto&#x27;,

  /**
    Sets the behavior of &#x60;xMax&#x60; for the graph.

    ### Possible values:

    - &#x27;auto&#x27;: (default) xMax is always equal to the maximum domain value contained in the graphed data. Cannot be set.
    - &#x27;fixed&#x27;: xMax can be set to an exact value and will not change based on graphed data.
    - &#x27;push&#x27;: xMax can be set to a specific value, but will update if the maximum x value contained in the graph is greater than 
      what xMax is currently set to.
    - &#x27;push-tick&#x27;: xMax can be set to a specific value, but will update to next &quot;nice&quot; tick if the maximum x value contained in
      the graph is greater than that xMax is set to.
      
    @property xMaxMode
    @type String
    @default &#x27;auto&#x27;
  */
  xMaxMode: &#x27;auto&#x27;,

  /**
    Sets the behavior of &#x60;yMin&#x60; for the graph.

    ### Possible values:

    - &#x27;auto&#x27;: (default) yMin is always equal to the minimum domain value contained in the graphed data. Cannot be set.
    - &#x27;fixed&#x27;: yMin can be set to an exact value and will not change based on graphed data.
    - &#x27;push&#x27;: yMin can be set to a specific value, but will update if the minimum y value contained in the graph is less than 
      what yMin is currently set to.
    - &#x27;push-tick&#x27;: yMin can be set to a specific value, but will update to next &quot;nice&quot; tick if the minimum y value contained in
      the graph is less than that yMin is set to.

    @property yMinMode
    @type String
    @default &#x27;auto&#x27;
  */
  yMinMode: &#x27;auto&#x27;,

  /**
    Sets the behavior of &#x60;yMax&#x60; for the graph.

    ### Possible values:

    - &#x27;auto&#x27;: (default) yMax is always equal to the maximum domain value contained in the graphed data. Cannot be set.
    - &#x27;fixed&#x27;: yMax can be set to an exact value and will not change based on graphed data.
    - &#x27;push&#x27;: yMax can be set to a specific value, but will update if the maximum y value contained in the graph is greater than 
      what yMax is currently set to.
    - &#x27;push-tick&#x27;: yMax can be set to a specific value, but will update to next &quot;nice&quot; tick if the maximum y value contained in
      the graph is greater than that yMax is set to.
      
    @property yMaxMode
    @type String
    @default &#x27;auto&#x27;
  */
  yMaxMode: &#x27;auto&#x27;,

  /**
    The data extents for all data in the registered &#x60;graphics&#x60;.

    @property dataExtents
    @type {Object}
    @default {
      xMin: Number.MAX_VALUE,
      xMax: Number.MIN_VALUE,
      yMin: Number.MAX_VALUE,
      yMax: Number.MIN_VALUE
    }
  */
  dataExtents: Ember.computed(&#x27;graphics.@each.data&#x27;, function(){
    var graphics = this.get(&#x27;graphics&#x27;);
    return graphics.reduce((c, x) =&gt; c.concat(x.get(&#x27;mappedData&#x27;)), []).reduce((extents, [x, y]) =&gt; {
      extents.xMin = extents.xMin &lt; x ? extents.xMin : x;
      extents.xMax = extents.xMax &gt; x ? extents.xMax : x;
      extents.yMin = extents.yMin &lt; y ? extents.yMin : y;
      extents.yMax = extents.yMax &gt; y ? extents.yMax : y;
      return extents;
    }, {
      xMin: Number.MAX_VALUE,
      xMax: Number.MIN_VALUE,
      yMin: Number.MAX_VALUE,
      yMax: Number.MIN_VALUE
    });
  }),

  /**
    The action to trigger when the graph automatically updates the xScale 
    due to an &quot;auto&quot; &quot;push&quot; or &quot;push-tick&quot; domainMode.

    sends the graph component instance value as the argument.

    @property autoScaleXAction
    @type {string}
    @default null
  */
  autoScaleXAction: null,

  _sendAutoUpdateXAction() {
    this.autoScaleXAction(this);
  },

  _sendAutoUpdateYAction() {
    this.autoScaleYAction(this);
  },

  /**
    Event handler that is fired for the &#x60;didAutoUpdateMaxX&#x60; event
    @method didAutoUpdateMaxX
  */
  didAutoUpdateMaxX() {
    Ember.run.once(this, this._sendAutoUpdateXAction);
  },

  /**
    Event handler that is fired for the &#x60;didAutoUpdateMinX&#x60; event
    @method didAutoUpdateMinX
  */
  didAutoUpdateMinX() {
    Ember.run.once(this, this._sendAutoUpdateXAction);
  },

  /**
    Event handler that is fired for the &#x60;didAutoUpdateMaxY&#x60; event
    @method didAutoUpdateMaxY
  */
  didAutoUpdateMaxY() {
    Ember.run.once(this, this._sendAutoUpdateYAction);
  },

  /**
    Event handler that is fired for the &#x60;didAutoUpdateMinY&#x60; event
    @method didAutoUpdateMinY
  */
  didAutoUpdateMinY() {
    Ember.run.once(this, this._sendAutoUpdateYAction);
  },

  /**
    The action to trigger when the graph automatically updates the yScale 
    due to an &quot;auto&quot; &quot;push&quot; or &quot;push-tick&quot; domainMode.

    Sends the graph component instance as the argument.

    @property autoScaleYAction
    @type {string}
    @default null
  */
  autoScaleYAction: null,

  /**
    Gets the highest and lowest x values of the graphed data in a two element array.
    @property xDataExtent
    @type Array
    @readonly
  */
  xDataExtent: Ember.computed(&#x27;dataExtents&#x27;, function(){
    var { xMin, xMax } = this.get(&#x27;dataExtents&#x27;);
    return [xMin, xMax];
  }),

  /**
    Gets the highest and lowest y values of the graphed data in a two element array.
    @property yDataExtent
    @type Array
    @readonly
  */
  yDataExtent: Ember.computed(&#x27;dataExtents&#x27;, function(){
    var { yMin, yMax } = this.get(&#x27;dataExtents&#x27;);
    return [yMin, yMax];
  }),

  /**
    @property xUniqueData
    @type Array
    @readonly
  */
  xUniqueData: Ember.computed(&#x27;graphics.@each.mappedData&#x27;, function(){
    var graphics = this.get(&#x27;graphics&#x27;);
    var uniq = graphics.reduce((uniq, graphic) =&gt; {
      return graphic.get(&#x27;mappedData&#x27;).reduce((uniq, d) =&gt; {
        if(!uniq.some(x =&gt; x === d[0])) {
          uniq.push(d[0]);
        }
        return uniq;
      }, uniq);
    }, []);
    return Ember.A(uniq);
  }),


  /**
    @property yUniqueData
    @type Array
    @readonly
  */
  yUniqueData: Ember.computed(&#x27;graphics.@each.mappedData&#x27;, function(){
    var graphics = this.get(&#x27;graphics&#x27;);
    var uniq = graphics.reduce((uniq, graphic) =&gt; {
      return graphic.get(&#x27;mappedData&#x27;).reduce((uniq, d) =&gt; {
        if(!uniq.some(y =&gt; y === d[1])) {
          uniq.push(d[1]);
        }
        return uniq;
      }, uniq);
    }, []);
    return Ember.A(uniq);
  }),

  /**
    Gets the DOM id for the content clipPath element.
    @property contentClipPathId
    @type String
    @readonly
    @private
  */
  contentClipPathId: Ember.computed(&#x27;elementId&#x27;, function(){
    return this.get(&#x27;elementId&#x27;) + &#x27;-content-mask&#x27;;
  }),

  /**
    Registry of contained graphic elements such as &#x60;nf-line&#x60; or &#x60;nf-area&#x60; components.
    This registry is used to pool data for scaling purposes.
    @property graphics
    @type Array
    @readonly
   */
  graphics: Ember.computed(function(){
    return Ember.A();
  }),

  /**
    An array of &quot;selectable&quot; graphics that have been selected within this graph.
    @property selected
    @type Array
    @readonly
  */
  selected: null,

  /**
    Computed property to show yAxis. Returns &#x60;true&#x60; if a yAxis is present.
    @property showYAxis
    @type Boolean
    @default false
   */
  showYAxis: computedBool(&#x27;yAxis&#x27;),

  /**
    Computed property to show xAxis. Returns &#x60;true&#x60; if an xAxis is present.
    @property showXAxis
    @type Boolean
    @default false
   */
  showXAxis: computedBool(&#x27;xAxis&#x27;),

  /**
    Gets a function to create the xScale
    @property xScaleFactory
    @readonly
   */
  xScaleFactory: scaleFactoryProperty(&#x27;x&#x27;),

  /**
    Gets a function to create the yScale
    @property yScaleFactory
    @readonly
   */
  yScaleFactory: scaleFactoryProperty(&#x27;y&#x27;),

  /**
    Gets the domain of x values.
    @property xDomain
    @type Array
    @readonly
   */
  xDomain: domainProperty(&#x27;x&#x27;),

  /**
    Gets the domain of y values.
    @property yDomain
    @type Array
    @readonly
   */
  yDomain: domainProperty(&#x27;y&#x27;),

  /**
    Gets the current xScale used to draw the graph.
    @property xScale
    @type Function
    @readonly
   */
  xScale: scaleProperty(&#x27;x&#x27;),

  /**
    Gets the current yScale used to draw the graph.
    @property yScale
    @type Function
    @readonly
   */
  yScale: scaleProperty(&#x27;y&#x27;),

  /**
    Registers a graphic such as &#x60;nf-line&#x60; or &#x60;nf-area&#x60; components with the graph.
    @method registerGraphic
    @param graphic {Ember.Component} The component object to register
   */
  registerGraphic: function (graphic) {
    var graphics = this.get(&#x27;graphics&#x27;);
    graphics.pushObject(graphic);
    graphic.on(&#x27;hasData&#x27;, this, this.updateExtents);
  },

  /**
    Unregisters a graphic such as an &#x60;nf-line&#x60; or &#x60;nf-area&#x60; from the graph.
    @method unregisterGraphic
    @param graphic {Ember.Component} The component to unregister
   */
  unregisterGraphic: function(graphic) {
    graphic.off(&#x27;hasData&#x27;, this, this.updateExtents);
    var graphics = this.get(&#x27;graphics&#x27;);
    graphics.removeObject(graphic);
  },
  
  updateExtents() {
    this.get(&#x27;xDataExtent&#x27;);
    this.get(&#x27;yDataExtent&#x27;);
  },

  /**
    The y range of the graph in pixels. The min and max pixel values
    in an array form.
    @property yRange
    @type Array
    @readonly
   */
  yRange: Ember.computed(&#x27;graphHeight&#x27;, function(){ 
    return [this.get(&#x27;graphHeight&#x27;), 0];
  }),

  /**
    The x range of the graph in pixels. The min and max pixel values
    in an array form.
    @property xRange
    @type Array
    @readonly
   */
  xRange: Ember.computed(&#x27;graphWidth&#x27;, function(){
    return [0, this.get(&#x27;graphWidth&#x27;)];
  }),

  /**
    Returns &#x60;true&#x60; if the graph has data to render. Data is conveyed
    to the graph by registered graphics.
    @property hasData
    @type Boolean
    @default false
    @readonly
   */
  hasData: Ember.computed.notEmpty(&#x27;graphics&#x27;),

  /**
    The x coordinate position of the graph content
    @property graphX
    @type Number
    @readonly
   */
  graphX: Ember.computed(&#x27;paddingLeft&#x27;, &#x27;yAxis.width&#x27;, &#x27;yAxis.orient&#x27;, function() {
    var paddingLeft = this.get(&#x27;paddingLeft&#x27;);
    var yAxisWidth = this.get(&#x27;yAxis.width&#x27;) || 0;
    var yAxisOrient = this.get(&#x27;yAxis.orient&#x27;);
    if(yAxisOrient === &#x27;right&#x27;) {
      return paddingLeft;
    }
    return paddingLeft + yAxisWidth;
  }),

  /** 
    The y coordinate position of the graph content
    @property graphY
    @type Number
    @readonly
   */
  graphY: Ember.computed(&#x27;paddingTop&#x27;, &#x27;xAxis.orient&#x27;, &#x27;xAxis.height&#x27;, function(){
    var paddingTop = this.get(&#x27;paddingTop&#x27;);
    var xAxisOrient = this.get(&#x27;xAxis.orient&#x27;);
    if(xAxisOrient === &#x27;top&#x27;) {
      var xAxisHeight = this.get(&#x27;xAxis.height&#x27;) || 0;
      return xAxisHeight + paddingTop;
    }
    return paddingTop;
  }), 

  /**
    The width, in pixels, of the graph content
    @property graphWidth
    @type Number
    @readonly
   */
  graphWidth: Ember.computed(&#x27;width&#x27;, &#x27;paddingRight&#x27;, &#x27;paddingLeft&#x27;, &#x27;yAxis.width&#x27;, function() {
    var paddingRight = this.get(&#x27;paddingRight&#x27;) || 0;
    var paddingLeft = this.get(&#x27;paddingLeft&#x27;) || 0;
    var yAxisWidth = this.get(&#x27;yAxis.width&#x27;) || 0;
    var width = this.get(&#x27;width&#x27;) || 0;
    return Math.max(0, width - paddingRight - paddingLeft - yAxisWidth);
  }),

  /**
    The height, in pixels, of the graph content
    @property graphHeight
    @type Number
    @readonly
   */
  graphHeight: Ember.computed(&#x27;height&#x27;, &#x27;paddingTop&#x27;, &#x27;paddingBottom&#x27;, &#x27;xAxis.height&#x27;, function(){
    var paddingTop = this.get(&#x27;paddingTop&#x27;) || 0;
    var paddingBottom = this.get(&#x27;paddingBottom&#x27;) || 0;
    var xAxisHeight = this.get(&#x27;xAxis.height&#x27;) || 0;
    var height = this.get(&#x27;height&#x27;) || 0;
    return Math.max(0, height - paddingTop - paddingBottom - xAxisHeight);
  }),

  /**
    An SVG transform to position the graph content
    @property graphTransform
    @type String
    @readonly
   */
  graphTransform: Ember.computed(&#x27;graphX&#x27;, &#x27;graphY&#x27;, function(){
    var graphX = this.get(&#x27;graphX&#x27;);
    var graphY = this.get(&#x27;graphY&#x27;);
    return &#x60;translate(${graphX} ${graphY})&#x60;;
  }),

  /**
    Sets &#x60;hasRendered&#x60; to &#x60;true&#x60; on &#x60;willInsertElement&#x60;.
    @method _notifyHasRendered
    @private
  */
  _notifyHasRendered: Ember.on(&#x27;willInsertElement&#x27;, function () {
    this.set(&#x27;hasRendered&#x27;, true);
  }),

  /**
    Gets the mouse position relative to the container
    @method mousePoint
    @param container {SVGElement} the SVG element that contains the mouse event
    @param e {Object} the DOM mouse event
    @return {Array} an array of &#x60;[xMouseCoord, yMouseCoord]&#x60;
   */
  mousePoint: function (container, e) {
    var svg = container.ownerSVGElement || container;
    if (svg.createSVGPoint) {
      var point = svg.createSVGPoint();
      point.x = e.clientX;
      point.y = e.clientY;
      point = point.matrixTransform(container.getScreenCTM().inverse());
      return [ point.x, point.y ];
    }
    var rect = container.getBoundingClientRect();
    return [ e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop ];
  },

  /**
    A computed property returned the view&#x27;s controller.
    @property parentController
    @type Ember.Controller
    @readonly
  */
  parentController: Ember.computed.alias(&#x27;templateData.view.controller&#x27;),

  /**
    Selects the graphic passed. If &#x60;selectMultiple&#x60; is false, it will deselect the currently
    selected graphic if it&#x27;s different from the one passed.
    @method selectGraphic
    @param graphic {Ember.Component} the graph component to select within the graph.
  */
  selectGraphic: function(graphic) {
    if(!graphic.get(&#x27;selected&#x27;)) {
      graphic.set(&#x27;selected&#x27;, true);
    }
    if(this.selectMultiple) {
      this.get(&#x27;selected&#x27;).pushObject(graphic);
    } else {
      var current = this.get(&#x27;selected&#x27;);
      if(current &amp;&amp; current !== graphic) {
        current.set(&#x27;selected&#x27;, false);
      }
      this.set(&#x27;selected&#x27;, graphic);
    }
  },

  /**
    deselects the graphic passed.
    @method deselectGraphic
    @param graphic {Ember.Component} the graph child component to deselect.
  */
  deselectGraphic: function(graphic) {
    graphic.set(&#x27;selected&#x27;, false);
    if(this.selectMultiple) {
      this.get(&#x27;selected&#x27;).removeObject(graphic);
    } else {
      var current = this.get(&#x27;selected&#x27;);
      if(current &amp;&amp; current === graphic) {
        this.set(&#x27;selected&#x27;, null);
      }
    }
  },

  /**
    The initialization method. Fired on &#x60;init&#x60;.
    @method _setup
    @private
  */
  init() {
    this._super(...arguments);
    this.set(&#x27;selected&#x27;, this.selectMultiple ? Ember.A() : null);
  },

  /**
    The amount of leeway, in pixels, to give before triggering a brush start.
    @property brushThreshold
    @type {Number}
    @default 7
  */
  brushThreshold: 7,

  /**
    The name of the action to trigger when brushing starts
    @property brushStartAction
    @type {String}
    @default null
  */
  brushStartAction: null,

  /**
    The name of the action to trigger when brushing emits a new value
    @property brushAction
    @type {String}
    @default null
  */
  brushAction: null,

  /**
    The name of the action to trigger when brushing ends
    @property brushEndAction
    @type {String}
    @default null
  */
  brushEndAction: null,

  _setupBrushAction: Ember.on(&#x27;didInsertElement&#x27;, function(){
    var content = this.$(&#x27;.nf-graph-content&#x27;);

    var mouseMoves = Observable.fromEvent(content, &#x27;mousemove&#x27;);
    var mouseDowns = Observable.fromEvent(content, &#x27;mousedown&#x27;);
    var mouseUps = Observable.fromEvent(Ember.$(document), &#x27;mouseup&#x27;);
    var mouseLeaves = Observable.fromEvent(content, &#x27;mouseleave&#x27;);

    this._brushDisposable = Observable.merge(mouseDowns, mouseMoves, mouseLeaves).
      // get a streams of mouse events that start on mouse down and end on mouse up
      window(mouseDowns, function() { return mouseUps; })
      // filter out all of them if there are no brush actions registered
      // map the mouse event streams into brush event streams
      .map(x =&gt; this._toBrushEventStreams(x)).
      // flatten to a stream of action names and event objects
      flatMap(x =&gt; this._toComponentEventStream(x)).
      // HACK: this is fairly cosmetic, so skip errors.
      retry().
      // subscribe and send the brush actions via Ember
      subscribe(x =&gt; {
        Ember.run(this, () =&gt; this._triggerComponentEvent(x));
      });
  }),

  _toBrushEventStreams: function(mouseEvents) {
    // get the starting mouse event
    return mouseEvents.take(1).
      // calculate it&#x27;s mouse point and info
      map( this._getStartInfo ).
      // combine the start with the each subsequent mouse event
      combineLatest(mouseEvents.skip(1), toArray).
      // filter out everything until the brushThreshold is crossed
      filter(x =&gt; this._byBrushThreshold(x)).
      // create the brush event object
      map(x =&gt; this._toBrushEvent(x));
  },

  _triggerComponentEvent: function(d) {
    this.trigger(d[0], d[1]);
  },

  _toComponentEventStream: function(events) {
    return Observable.merge(
      events.take(1).map(function(e) {
        return [&#x27;didBrushStart&#x27;, e];
      }), events.map(function(e) {
        return [&#x27;didBrush&#x27;, e];
      }), events.last().map(function(e) {
        return [&#x27;didBrushEnd&#x27;, e];
      })
    );
  },

  didBrush: function(e) {
    if(this.get(&#x27;brushAction&#x27;)) {
      this.brushAction(e);
    }
  },

  didBrushStart: function(e) {
    document.body.style.setProperty(&#x27;-webkit-user-select&#x27;, &#x27;none&#x27;);
    document.body.style.setProperty(&#x27;-moz-user-select&#x27;, &#x27;none&#x27;);
    document.body.style.setProperty(&#x27;user-select&#x27;, &#x27;none&#x27;);
    if(this.get(&#x27;brushStartAction&#x27;)) {
      this.brushStartAction(e);
    }
  },

  didBrushEnd: function(e) {
    document.body.style.removeProperty(&#x27;-webkit-user-select&#x27;);
    document.body.style.removeProperty(&#x27;-moz-user-select&#x27;);
    document.body.style.removeProperty(&#x27;user-select&#x27;);
    if(this.get(&#x27;brushEndAction&#x27;)) {
      this.brushEndAction(e);
    }
  },

  _toBrushEvent: function(d) {
    var start = d[0];
    var currentEvent =  d[1];
    var currentPoint = getMousePoint(currentEvent.currentTarget, d[1]);

    var startPosition = GraphPosition.create({
      originalEvent: start.originalEvent,
      graph: this,
      graphX: start.mousePoint.x,
      graphY: start.mousePoint.y
    });

    var currentPosition = GraphPosition.create({
      originalEvent: currentEvent,
      graph: this,
      graphX: currentPoint.x,
      graphY: currentPoint.y
    });

    var left = startPosition;
    var right = currentPosition;

    if(start.originalEvent.clientX &gt; currentEvent.clientX) {
      left = currentPosition;
      right = startPosition;
    }

    return {
      start: startPosition,
      current: currentPosition,
      left: left,
      right: right
    }; 
  },

  _byBrushThreshold: function(d) {
    var startEvent = d[0].originalEvent;
    var currentEvent = d[1];
    return Math.abs(currentEvent.clientX - startEvent.clientX) &gt; this.get(&#x27;brushThreshold&#x27;);
  },

  _getStartInfo: function(e) {
    return {
      originalEvent: e,
      mousePoint: getMousePoint(e.currentTarget, e)
    };
  },

  willDestroyElement: function(){
    if(this._brushDisposable) {
      this._brushDisposable.dispose();
    }
  },
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
